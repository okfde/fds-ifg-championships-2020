{"version":3,"sources":["teams.js","hero-animations.js","tournament-visual.js"],"names":["teams","bw","captain","firstName","lastName","state","img","by","be","bb","hb","hh","he","mv","ni","nw","rp","sl","sn","st","sh","th","getRandomArbitrary","min","max","Math","random","deslayTimes","result","i","last","push","createDelayTimes","animateImage","imgPath","container","containerSize","randomDelay","floor","length","setTimeout","el","imgEl","document","createElement","classList","add","setAttribute","appendChild","imgHeight","clientHeight","imgWidth","clientWidth","randomY","h","round","targetXPos","w","style","top","left","transform","concat","transition","removeChild","imgDirPath","querySelector","teamsArr","Object","values","l","renderAnimations","getElementById","src","replace","rounds","title","matches","number","team1","team2","betURL","betPrefix","getBet","callback","data","request","XMLHttpRequest","open","setRequestHeader","value","onload","this","status","JSON","parse","response","window","alert","onerror","send","imagePath","loggedIn","namePlaceholder","userBets","loading","minBettableMatchNumber","bettingDeadline","Date","placeBet","e","preventDefault","team","dataset","matchNumber","match","now","name","prompt","substr","renderBetByMatch","error","user","encodeURIComponent","createTournament","rootContainer","innerHTML","matchesArr","createTeam","winner","join","createMatches","createRounds","betStars","querySelectorAll","Array","from","forEach","betStar","addEventListener","key","props","isWinner","canBet","charAt","renderBet","bettable","r","pathHelperImage","textContent"],"mappings":"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","file":"main.js","sourcesContent":["const teams = {\n  bw: {\n    captain: {\n      firstName: 'Winfried',\n      lastName: 'Kretschmann'\n    },\n    state: 'Baden-Württemberg',\n    img: 'kretschmann.png'\n  },\n  by: {\n    captain: {\n      firstName: 'Markus',\n      lastName: 'Söder'\n    },\n    state: 'Bayern',\n    img: 'soeder.png'\n  },\n  be: {\n    captain: {\n      firstName: 'Michael',\n      lastName: 'Müller'\n    },\n    state: 'Berlin',\n    img: 'mueller.png'\n  },\n  bb: {\n    captain: {\n      firstName: 'Dietmar',\n      lastName: 'Woidke'\n    },\n    state: 'Brandenburg',\n    img: 'woidke.png'\n  },\n  hb: {\n    captain: {\n      firstName: 'Andreas',\n      lastName: 'Bovenschulte'\n    },\n    state: 'Bremen',\n    img: 'bovenschulte.png'\n  },\n  hh: {\n    captain: {\n      firstName: 'Peter',\n      lastName: 'Tschentscher'\n    },\n    state: 'Hamburg',\n    img: 'tschentscher.png'\n  },\n  he: {\n    captain: {\n      firstName: 'Volker',\n      lastName: 'Bouffier'\n    },\n    state: 'Hessen',\n    img: 'bouffier.png'\n  },\n  mv: {\n    captain: {\n      firstName: 'Manuela',\n      lastName: 'Schwesig'\n    },\n    state: 'Mecklenburg-Vorpommern',\n    img: 'schwesig.png'\n  },\n  ni: {\n    captain: {\n      firstName: 'Stephan',\n      lastName: 'Weil'\n    },\n    state: 'Niedersachsen',\n    img: 'weil.png'\n  },\n  nw: {\n    captain: {\n      firstName: 'Armin',\n      lastName: 'Laschet'\n    },\n    state: 'Nordrhein-Westfalen',\n    img: 'laschet.png'\n  },\n  rp: {\n    captain: {\n      firstName: 'Malu',\n      lastName: 'Dreyer'\n    },\n    state: 'Rheinland-Pfalz',\n    img: 'dreyer.png'\n  },\n  sl: {\n    captain: {\n      firstName: 'Tobias',\n      lastName: 'Hans'\n    },\n    state: 'Saarland',\n    img: 'hans.png'\n  },\n  sn: {\n    captain: {\n      firstName: 'Michael',\n      lastName: 'Kretschmer'\n    },\n    state: 'Sachsen',\n    img: 'kretschmer.png'\n  },\n  st: {\n    captain: {\n      firstName: 'Reiner',\n      lastName: 'Haseloff'\n    },\n    state: 'Sachsen-Anhalt',\n    img: 'haseloff.png'\n  },\n  sh: {\n    captain: {\n      firstName: 'Daniel',\n      lastName: 'Günther'\n    },\n    state: 'Schleswig-Holstein',\n    img: 'guenther.png'\n  },\n  th: {\n    captain: {\n      firstName: 'Bodo',\n      lastName: 'Ramelow'\n    },\n    state: 'Thüringen',\n    img: 'ramelow.png'\n  },\n}","(function(){\n\n  function init () {\n    const pathHelperImage = document.getElementById('path-helper')\n    const imgDirPath = pathHelperImage.src.replace('1x1.png', '')\n    renderAnimations(imgDirPath)\n  }\n\n  function renderAnimations (imgDirPath) {\n    const container = document.querySelector('.hero')\n    const containerSize = { w: container.clientWidth, h: container.clientHeight }\n    const teamsArr = Object.values(teams)\n\n    // create, insert and animate images\n    const allImgs = []\n    for (let i = 0, l = teamsArr.length; i < l; i++) {\n      const imgPath = imgDirPath + teamsArr[i].img\n      animateImage(imgPath, container, containerSize)\n    }\n  }\n\n  function renderImage (imgPath) {\n    const el = document.createElement('img')\n    el.classList.add('floating-head')\n    el.setAttribute('src', imgPath)\n    return el\n  }\n\n  function getRandomArbitrary(min, max) {\n    return Math.random() * (max - min) + min;\n  }\n\n  function getAnimationTime () {\n    const miliseconds = 20000\n    return miliseconds\n  }\n\n  function createDelayTimes () {\n    const result = []\n    let i = 16\n    let last = 0\n    while (i--) {\n      last = last + getRandomArbitrary(2000, 2500)\n      result.push(last)\n    }\n    return result\n  }\n\n  const deslayTimes = createDelayTimes()\n  function getDelayTime () {\n    const randomTime = deslayTimes[Math.floor(Math.random() * deslayTimes.length)];\n    return randomTime\n  }\n  \n  function animateImage (imgPath, container, containerSize) {\n    const randomDelay = getDelayTime()\n\n    setTimeout(() => {\n      const imgEl = renderImage(imgPath)\n      container.appendChild(imgEl)\n      \n      const miliseconds = getAnimationTime()\n      const imgHeight = imgEl.clientHeight\n      const imgWidth = imgEl.clientWidth\n      const minY = imgHeight / 2\n      const maxY = containerSize.h - Math.round(imgHeight * 1.5)\n      const randomY = getRandomArbitrary(minY, maxY)\n      const targetXPos = containerSize.w + imgWidth\n  \n      imgEl.style.top = randomY + 'px'\n      imgEl.style.left = -(imgWidth) + 'px'\n      imgEl.style.transform = `translate(${targetXPos}px, 0)`;\n      imgEl.style.transition = `all ${miliseconds}ms linear`;\n      setTimeout(() => {\n        container.removeChild(imgEl)\n        animateImage(imgPath, container, containerSize)\n      }, miliseconds);      \n    }, randomDelay)\n  }\n\n  init()\n\n}())","(function(){\n\n  const rounds = [\n    {\n      title: 'Runde 1',\n      matches: [\n        {\n          number: 1,\n          team1: 'sh',\n          team2: 'st',\n          // winner: ''\n        },\n        {\n          number: 2,\n          team1: 'hb',\n          team2: 'mv',\n          // winner: ''\n        },\n        {\n          number: 3,\n          team1: 'rp',\n          team2: 'he',\n          // winner: ''\n        },\n        {\n          number: 4,\n          team1: 'be',\n          team2: 'bb',\n          // winner: ''\n        },\n        {\n          number: 5,\n          team1: 'nw',\n          team2: 'ni',\n          // winner: ''\n        },\n        {\n          number: 6,\n          team1: 'sn',\n          team2: 'by',\n          // winner: ''\n        },\n        {\n          number: 7,\n          team1: 'hh',\n          team2: 'bw',\n          // winner: ''\n        },\n        {\n          number: 8,\n          team1: 'sl',\n          team2: 'th',\n          // winner: ''\n        },\n      ]\n    },\n    {\n      title: 'Runde 2',\n      matches: [\n        // {\n        //   number: 9,\n        //   team1: '',\n        //   team2: '',\n        //   winner: ''\n        // },\n        // {\n        //   number: 10,\n        //   team1: '',\n        //   team2: '',\n        //   winner: ''\n        // },\n        // {\n        //   number: 11,\n        //   team1: '',\n        //   team2: '',\n        //   winner: ''\n        // },\n        // {\n        //   number: 12,\n        //   team1: '',\n        //   team2: '',\n        //   winner: ''\n        // },\n      ]\n    },\n    {\n      title: 'Halbfinale',\n      matches: [\n        // {\n        //   number: 13,\n        //   team1: '',\n        //   team2: '',\n        //   winner: ''\n        // },\n        // {\n        //   number: 14,\n        //   team1: '',\n        //   team2: '',\n        //   winner: ''\n        // },\n      ]\n    },\n    {\n      title: 'Finale',\n      matches: [\n        // {\n        //   number: 15,\n        //   team1: '',\n        //   team2: '',\n        //   winner: ''\n        // },\n      ]\n    },\n  ]\n\n  const betURL = '/tippspiel/'\n  const betPrefix = 'fds_meisterschaften_2020_'\n\n  function getBet(callback, data) {\n    var request = new XMLHttpRequest();\n    request.open(data ? 'POST' : 'GET', betURL, true);\n    if (data) {\n      request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');\n      request.setRequestHeader('X-CSRFToken', document.querySelector('[name=csrfmiddlewaretoken]').value)\n    }\n    request.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n    request.onload = function() {\n      if (this.status >= 200 && this.status < 400) {\n        // Success!\n        var data = JSON.parse(this.response);\n        callback(data)\n      } else {\n        // We reached our target server, but it returned an error\n        window.alert('Error')\n      }\n    };\n    request.onerror = function() {\n      window.alert('Error')\n    };\n    request.send(data);\n  }\n\n  var imagePath = \"img/\"\n  var loggedIn = false\n  var namePlaceholder = ''\n  var userBets = {}\n  var loading = false\n  var minBettableMatchNumber = 1\n  var bettingDeadline = new Date(1591956000 * 1000) // Fri, 12 Jun 12:00 UTC + 2\n\n  rounds.forEach(r => {\n    if (r.matches.length > 0) {\n      minBettableMatchNumber = r.matches[0].number\n    }\n  })\n\n  function init () {\n    const pathHelperImage = document.getElementById('path-helper')\n    imagePath = pathHelperImage.src.replace('1x1.png', '')\n    loggedIn = document.getElementById('userDropdownMenu') !== null\n    if (loggedIn) {\n      namePlaceholder = document.querySelector('#userDropdownMenu span').textContent\n    }\n\n    if (!loggedIn) {\n      createTournament()\n    } else {\n      getBet(function (data) {\n        userBets = data.user || {}\n        createTournament()\n      })\n    }\n  }\n\n  function placeBet (e) {\n    e.preventDefault()\n    const el = this\n    const team = el.dataset.team\n    const matchNumber = el.dataset.match\n\n    if (!loggedIn) {\n      window.alert(\"Sie müssen eingeloggt sein, um am Tippspiel teilzunehmen.\")\n      return\n    }\n    const now = new Date()\n    if (bettingDeadline && bettingDeadline < now) {\n      window.alert(\"Die aktuelle Tipp-Spiel-Runde ist abgelaufen!\")\n      return\n    }\n\n    if (!userBets[betPrefix + \"name\"]) {\n      let name = window.prompt(\"Unter welchem Namen möchten Sie in der Tipp-Tabelle erscheinen? Durch die Eingabe stimmen Sie unseren Teilnahmebedingungen zu.\", namePlaceholder);\n      if (name === null) {\n        return\n      }\n      userBets[betPrefix + \"name\"] = name.substr(0, 50)\n    }\n    if (loading) {\n      window.alert(\"Ihre letzte Aktion wird noch verarbeitet.\")\n      return\n    }\n\n    userBets[betPrefix + matchNumber] = team\n    loading = true\n    renderBetByMatch(matchNumber, true)\n\n    getBet(function (data) {\n      if (data.error) {\n        window.alert(data.error)\n      } else {\n        userBets = data.user || {}\n      }\n      loading = false\n      renderBetByMatch(matchNumber, false)\n    }, `match=${matchNumber}&bet=${team}&name=${encodeURIComponent(userBets[betPrefix + \"name\"])}`)\n\n  }\n\n\n  function createTournament () {\n    rootContainer.innerHTML =`\n      <div class=\"tournament-bracket tournament-bracket--rounded\">\n        ${createRounds(rounds)}\n      </div>\n      `\n    const betStars = rootContainer.querySelectorAll('.tournament-bracket__tip a')\n    Array.from(betStars).forEach((betStar) => {\n      betStar.addEventListener('click', placeBet)\n    })\n  }\n\n  function createRounds (rounds) {\n    let result = ''\n    for (let i = 0, l = rounds.length; i < l; i++) {\n      result += createRound(rounds[i], i + 1)\n    }\n    return result\n  }\n\n  function createRound (round) {\n    return `\n    <div class=\"tournament-bracket__round\">\n      <h3 class=\"tournament-bracket__round-title\">${round.title}</h3>\n      ${round.matches && round.matches.length > 0 ? `\n      <ul class=\"tournament-bracket__list\">\n        ${createMatches(round.matches)}\n      </ul>\n      ` : ''}\n    </div>\n    `\n  }\n\n  function createMatches (matchesArr) {\n    let result = []\n    for (let i = 0, l = matchesArr.length; i < l; i++) {\n      result.push(createMatch(matchesArr[i]))\n    }\n    return result.join('')\n  }\n\n  function createMatch (match) {\n    const team1 = teams[match.team1]\n    const team2 = teams[match.team2]\n\n    return `\n    <li class=\"tournament-bracket__item\">\n      <div class=\"tournament-bracket__match\" tabindex=\"0\">\n        <table class=\"tournament-bracket__table\">\n          <tbody class=\"tournament-bracket__content\">\n            ${createTeam(match.team1, team1, match.winner === 'team1', match)}\n            ${createTeam(match.team2, team2, match.winner === 'team2', match)}\n          </tbody>\n        </table>\n      </div>\n    </li>\n    `\n  }\n\n  function createTeam (key, props, isWinner, match) {\n    const matchNumber = match.number\n    const title = `${props.captain.firstName} ${props.captain.lastName} (${props.state})`\n    const now = new Date()\n    const canBet = matchNumber >= minBettableMatchNumber && (!bettingDeadline || now < bettingDeadline)\n    return `\n    <tr class=\"tournament-bracket__team\">\n      <td class=\"tournament-bracket__image\" title=\"${title}\"><img src=\"${imagePath}${props.img}\"></td>\n      <td class=\"tournament-bracket__label\" title=\"${title}\">\n        <span class=\"tournament-bracket__name\">\n          ${match.request ? `<a href=\"/a/${match.request}\">` : ''}\n          ${props.captain.firstName.charAt(0)}. ${props.captain.lastName}\n          ${match.request ? '</a>' : ''}\n        </span>&nbsp;<span class=\"tournament-bracket__token\" title=\"${props.state}\">(${key})</span>\n      </td>\n      <td class=\"tournament-bracket__result\" title=\"Gewinner\">${isWinner ? '🏆️&nbsp;' : ''}</td>\n      <td class=\"tournament-bracket__tip\">\n        ${ canBet ?\n          `<a href=\"#\" data-team=\"${key}\" data-match=\"${matchNumber}\">${renderBet(key, matchNumber, true)}</a>` :\n          renderBet(key, matchNumber, false)\n        }\n      </td>\n    </tr>\n    `\n  }\n\n  function renderBetByMatch (matchNumber, loading) {\n    const betStars = rootContainer.querySelectorAll(`.tournament-bracket__tip a[data-match=\"${matchNumber}\"]`)\n    Array.from(betStars).forEach((betStar) => {\n      if (loading) {\n        betStar.innerHTML = `<i class=\"fa fa-spinner\" aria-hidden=\"true\"></i>`\n      } else {\n        betStar.innerHTML = renderBet(betStar.dataset.team, matchNumber, true)\n      }\n    })\n  }\n\n  function renderBet (team, matchNumber, bettable) {\n    if (userBets) {\n      const betted = userBets[betPrefix + matchNumber] === team\n      if (betted) {\n        return `<i class=\"fa fa-star\" aria-hidden=\"true\"></i>`\n      }\n    }\n    if (bettable) {\n      return `<i class=\"fa fa-star-o\" aria-hidden=\"true\"></i>`\n    }\n    return ``\n  }\n\n  const rootContainer = document.getElementById('tournament-visual')\n  init();\n\n}())"]}